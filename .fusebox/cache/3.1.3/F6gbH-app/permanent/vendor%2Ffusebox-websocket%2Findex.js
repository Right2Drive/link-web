{"version":3,"sources":["/vendor/fusebox-websocket/index.js"],"names":["false","Object","defineProperty","exports","value","events","require","SocketClient","opts","port","window","location","protocol","domain","hostname","url","host","uri","authSent","emitter","EventEmitter","prototype","reconnect","fn","_this","setTimeout","emit","message","connect","on","event","console","log","client","WebSocket","bindEvents","close","send","eventName","data","readyState","JSON","stringify","error","onopen","onerror","reason","onclose","code","onmessage","item","parse","type"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar events = require('events');\nvar SocketClient = /** @class */ (function () {\n    function SocketClient(opts) {\n        opts = opts || {};\n        var port = opts.port || window.location.port;\n        var protocol = location.protocol === 'https:' ? 'wss://' : 'ws://';\n        var domain = location.hostname || 'localhost';\n        this.url = opts.host || \"\" + protocol + domain + \":\" + port;\n        if (opts.uri) {\n            this.url = opts.uri;\n        }\n        this.authSent = false;\n        this.emitter = new events.EventEmitter();\n    }\n    SocketClient.prototype.reconnect = function (fn) {\n        var _this = this;\n        setTimeout(function () {\n            _this.emitter.emit('reconnect', { message: 'Trying to reconnect' });\n            _this.connect(fn);\n        }, 5000);\n    };\n    SocketClient.prototype.on = function (event, fn) {\n        this.emitter.on(event, fn);\n    };\n    SocketClient.prototype.connect = function (fn) {\n        var _this = this;\n        console.log('%cConnecting to fusebox HMR at ' + this.url, 'color: #237abe');\n        setTimeout(function () {\n            _this.client = new WebSocket(_this.url);\n            _this.bindEvents(fn);\n        }, 0);\n    };\n    SocketClient.prototype.close = function () {\n        this.client.close();\n    };\n    SocketClient.prototype.send = function (eventName, data) {\n        if (this.client.readyState === 1) {\n            this.client.send(JSON.stringify({ event: eventName, data: data || {} }));\n        }\n    };\n    SocketClient.prototype.error = function (data) {\n        this.emitter.emit('error', data);\n    };\n    /** Wires up the socket client messages to be emitted on our event emitter */\n    SocketClient.prototype.bindEvents = function (fn) {\n        var _this = this;\n        this.client.onopen = function (event) {\n            console.log('%cConnected', 'color: #237abe');\n            if (fn) {\n                fn(_this);\n            }\n        };\n        this.client.onerror = function (event) {\n            _this.error({ reason: event.reason, message: 'Socket error' });\n        };\n        this.client.onclose = function (event) {\n            _this.emitter.emit('close', { message: 'Socket closed' });\n            if (event.code !== 1011) {\n                _this.reconnect(fn);\n            }\n        };\n        this.client.onmessage = function (event) {\n            var data = event.data;\n            if (data) {\n                var item = JSON.parse(data);\n                _this.emitter.emit(item.type, item.data);\n                _this.emitter.emit('*', item);\n            }\n        };\n    };\n    return SocketClient;\n}());\nexports.SocketClient = SocketClient;\n"]}